const input = `

#.###########################################################################################################################################
#.#...#####...###...#...#...#.......#...#...###...#...#...###...#.......###...#...#.......#...###.....#...#...###...#...#...#...........#...#
#.#.#.#####.#.###.#.#.#.#.#.#.#####.#.#.#.#.###.#.#.#.#.#.###.#.#.#####.###.#.#.#.#.#####.#.#.###.###.#.#.#.#.###.#.#.#.#.#.#.#########.#.#.#
#.#.#...###.#...#.#.#.#.#.#.#.....#.#.#.#.#...#.#.#.#.#.#...#.#...#.....#...#.#.#...#.....#.#.....#...#.#.#.#.#...#.#.#.#.#.#.#.........#.#.#
#.#.###.###.###.#.#.#.#.#.#.#####.#.#.#.#.###.#.#.#.#.#.###.#.#####.#####.###.#.#####.#####.#######.###.#.#.#.#.###.#.#.#.#.#.#.#########.#.#
#.#.###...#...#...#.#.#...#...>.>.#...#.#...#...#...#.#...#.#.....#.#...#...#.#.#.....#####...#.....#...#.#.#.#...#.#.#.#.#.#.#.###.....#.#.#
#.#.#####.###.#####.#.#########v#######.###.#########.###.#.#####.#.#.#.###.#.#.#.###########.#.#####.###.#.#.###.#.#.#.#.#.#.#.###.###.#.#.#
#.#.#.....#...#.....#.........#...#.....#...#.........#...#.#.....#.#.#.#...#.#.#...#...>.>.#.#.#...#.#...#.#.#...#.#.#.#.#.#.#.....#...#.#.#
#.#.#.#####.###.#############.###.#.#####.###.#########.###.#.#####.#.#.#.###.#.###.#.###v#.#.#.#.#.#.#.###.#.#.###.#.#.#.#.#.#######.###.#.#
#...#.....#...#.....#...#.....###.#.#...#...#.#...#...#.#...#.....#.#.#...###.#.###...#...#...#.#.#.#.#.#...#...#...#.#.#.#...###.....#...#.#
#########.###.#####v#.#.#.#######.#.#.#.###.#.#.#.#.#.#.#.#######.#.#.#######.#.#######.#######.#.#.#.#.#.#######.###.#.#.#######.#####.###.#
#.....#...#...#...#.>.#.#.#.......#.#.#...#.#.#.#.#.#.#.#.#.>.>...#...#...###...#.......#...#...#.#.#.#.#.....###...#.#...###.....#...#...#.#
#.###.#.###.###.#.#v###.#.#.#######.#.###.#.#.#.#.#.#.#.#.#.#v#########.#.#######.#######.#.#.###.#.#.#.#####.#####.#.#######.#####.#.###.#.#
#.#...#.....###.#.#...#...#.......#.#...#.#.#...#...#...#...#.#####.....#.#...###.........#.#...#.#.#.#.>.>.#.....#.#...#.....#...#.#.....#.#
#.#.###########.#.###.###########.#.###.#.#.#################.#####.#####.#.#.#############.###.#.#.#.###v#.#####.#.###.#.#####.#.#.#######.#
#.#.............#.....#.....#.....#.....#...#...###...###...#.......#.....#.#.###...........#...#.#.#.#...#.......#...#.#.#...#.#...#.......#
#.#####################.###.#.###############.#.###.#.###.#.#########.#####.#.###.###########.###.#.#.#.#############.#.#.#.#.#.#####.#######
#.....#...#.............#...#.....#...###...#.#.....#.....#...#...#...#.....#...#.........###.....#...#.........#...#...#...#...#...#.......#
#####.#.#.#.#############.#######.#.#.###.#.#.###############.#.#.#.###.#######.#########.#####################.#.#.#############.#.#######.#
#####...#...#...#...#...#.#.....#.#.#.....#.#...#...#...#####.#.#.#.###...#...#...#...#...#...#.....#...###...#.#.#.#.......#.....#.........#
#############.#.#.#.#.#.#.#.###.#.#.#######.###.#.#.#.#.#####.#.#.#.#####.#.#.###.#.#.#.###.#.#.###.#.#.###.#.#.#.#.#.#####.#.###############
#.......#...#.#...#.#.#.#.#...#...#.#.......#...#.#...#.....#...#.#.....#...#...#...#...#...#.#...#...#.....#...#.#...#.....#.....#.........#
#.#####.#.#.#.#####.#.#.#.###.#####.#.#######.###.#########.#####.#####.#######.#########.###.###.###############.#####.#########.#.#######.#
#.....#...#.#...#...#.#.#.#...#...#.#.#.....#.....#...#...#.....#.#.....###...#.......###...#.....#.....#...#...#.#.....#...#.....#.#.......#
#####.#####.###.#.###.#.#.#.###.#.#.#.#.###.#######.#.#.#.#####.#.#.#######.#.#######.#####.#######.###.#.#.#.#.#.#.#####.#.#.#####.#.#######
#.....#...#.....#.....#...#...#.#...#...#...#.......#...#.......#...#...#...#.........#...#.........###...#...#...#.......#.#.......#.......#
#.#####.#.###################.#.#########.###.#######################.#.#.#############.#.#################################.###############.#
#.......#.................###...#.........###.....#.......#.....#...#.#.#.......#...###.#.....#.........###...#...#...#.....#...#.......#...#
#########################.#######.###############.#.#####.#.###.#.#.#.#.#######.#.#.###.#####.#.#######.###.#.#.#.#.#.#.#####.#.#.#####.#.###
#.......................#.#.....#.....#.......#...#.#.....#.#...#.#.#.#.#...#...#.#...#.#.....#.......#.....#...#...#...#.....#.#.....#.#...#
#.#####################.#.#.###.#####.#.#####.#.###.#.#####.#.###.#.#.#.#.#.#v###.###.#.#.###########.###################.#####.#####.#.###.#
#.#.............#.....#...#...#.#...#...#.....#.....#.....#.#...#.#...#.#.#.>.>.#.#...#.#.#.....#...#.......#.....#...###.....#.......#.#...#
#.#.###########.#.###.#######.#.#.#.#####.###############.#.###.#.#####.#.###v#.#.#.###.#.#.###.#.#.#######.#.###.#.#.#######.#########.#.###
#...#...#...#...#.#...#.......#...#.....#.......#.....#...#...#.#.#...#...#...#...#...#.#.#...#.#.#.###...#.#...#...#.....###.........#...###
#####.#.#.#.#.###.#.###.###############.#######.#.###.#.#####.#.#.#.#.#####.#########.#.#.###.#.#.#.###.#.#.###.#########.###########.#######
#.....#...#.#.....#...#...........#...#.........#...#...#.....#.#...#.#.....#####.....#.#...#.#.#.#.#...#.#.....#...#.....#...#.....#.......#
#.#########.#########.###########.#.#.#############.#####.#####.#####.#.#########.#####.###.#.#.#.#.#.###.#######.#.#.#####.#.#.###.#######.#
#.....#...#...........#...#.....#...#...#...#.....#.#...#.....#.#.....#.......#...#...#.###.#.#.#.#.#...#.#.......#...#...#.#.#...#.#.......#
#####.#.#.#############.#.#.###.#######.#.#.#.###.#.#.#.#####.#.#.###########.#.###.#.#.###.#.#.#.#.###.#.#v###########.#.#.#.###.#.#.#######
#.....#.#.#.......#...#.#.#.#...#.......#.#.#...#.#...#.#...#.#.#.#.....###...#.#...#.#.#...#.#.#.#.#...#.>.>.#.......#.#.#.#.#...#.#.......#
#.#####.#.#.#####.#.#.#.#.#.#.###.#######.#.###.#.#####v#.#.#.#.#.#.###.###.###.#.###.#.#.###.#.#.#.#.#####v#.#.#####.#.#.#.#.#.###.#######.#
#.#...#.#...#.....#.#.#.#.#.#.###.....#...#...#.#.....>.>.#...#.#.#...#.....###...#...#.#...#.#.#.#...###...#.#.#.....#.#.#.#.#.#...#.......#
#.#.#.#.#####v#####.#.#.#.#.#.#######v#.#####.#.#######v#######.#.###.#############.###.###.#.#.#.#######.###.#.#.#####.#.#.#.#.#.###v#######
#...#...#...#.>.....#.#.#...#...#...>.>.###...#...#.....###...#...###.............#...#.#...#.#.#.###...#...#...#...#...#.#.#.#.#...>.#.....#
#########.#.#v#######.#.#######.#.###v#####.#####.#.#######.#.###################.###.#.#.###.#.#.###.#.###.#######.#.###.#.#.#.#####v#.###.#
#.........#...#.....#.#.......#.#.###.....#.......#.........#.......#.............###.#.#...#.#.#.#...#.#...###...#.#...#.#.#.#.#.....#.#...#
#.#############.###.#.#######.#.#.#######.#########################.#.###############.#.###.#.#.#.#.###.#.#####.#.#.###.#.#.#.#.#.#####.#.###
#.......#...#...#...#.#...#...#.#.#.......#.......###...............#.#.....#.......#.#...#.#.#.#.#...#...#...#.#.#.#...#...#...#.......#...#
#######.#.#.#.###.###.#.#.#.###.#.#.#######.#####.###.###############.#.###.#.#####.#.###.#.#.#.#.###.#####.#.#.#.#.#.#####################.#
#.....#...#...###...#.#.#...###...#.......#.#...#.....#...#...#.....#...###...#...#.#.....#...#...#...#...#.#...#.#.#.#...#...#...#.........#
#.###.#############.#.#.#################.#.#.#.#######.#.#.#.#.###.###########.#.#.###############.###.#.#.#####.#.#.#.#.#.#.#.#.#.#########
#...#.#.............#...#.....#...###.....#.#.#...#...#.#.#.#...#...#...........#...#.....#.....###.....#.#.#.....#.#...#.#.#...#...#.......#
###.#.#.#################.###.#.#.###.#####.#.###.#.#.#.#.#.#####.###.###############.###.#.###.#########.#.#.#####.#####.#.#########.#####.#
#...#...#.............###...#...#.....#####...###...#.#.#.#.#.....###.............#...#...#...#.#.......#.#.#.....#.....#.#...........#.....#
#.#######.###########.#####.#########################.#.#.#.#.###################.#.###.#####.#.#.#####.#.#.#####.#####.#.#############.#####
#...#...#.#...........#.....#...........#...###...###...#...#.....#...#...........#...#.....#.#.#.....#.#...###...#...#...#.............#...#
###.#.#.#.#.###########.#####.#########.#.#.###.#.###############.#.#.#.#############.#####.#.#.#####.#.#######.###.#.#####.#############.#.#
###.#.#...#...........#.......#...#.....#.#...#.#...#.....#.....#.#.#.#.........#...#.#.....#.#.###...#.....#...#...#.....#...........#...#.#
###.#.###############.#########.#.#.#####.###.#.###.#.###.#.###.#.#.#.#########.#.#.#.#.#####.#.###.#######.#.###.#######.###########.#.###.#
###...#...............#.......#.#.#...###.#...#.#...#...#.#...#...#.#.#...#.....#.#...#.#...#.#...#.....#...#...#.#.......#...........#.#...#
#######.###############.#####.#.#.###v###.#.###.#.#####.#.###v#####.#.#.#.#.#####.#####.#.#.#.###.#####.#.#####.#.#.#######.###########.#.###
###...#...........#...#.....#.#.#...>.>...#.#...#...#...#.#.>.>.#...#.#.#.#.#...#...#...#.#.#...#.#...#.#.#...#.#.#...#.....#...........#.###
###.#.###########v#.#.#####.#.#.#####v#####.#.#####.#.###.#.#v#.#.###.#.#.#v#.#.###.#.###.#.###.#.#.#.#.#.#.#.#v#.###.#.#####.###########.###
#...#.....###...#.>.#.#...#.#.#.....#.....#.#...#...#...#.#.#.#...#...#.#.>.>.#.....#...#.#.....#.#.#.#.#.#.#.>.>.#...#.......###...#...#...#
#.#######.###.#.#v###.#.#.#.#.#####.#####.#.###.#.#####.#.#.#.#####.###.###v###########.#.#######.#.#.#.#.#.###v###.#############.#.#.#.###.#
#...#.....#...#.#.###.#.#.#.#.#...#.#.....#.....#...#...#...#.....#.....#...#.........#.#...#.....#.#.#.#.#.###...#...#...###...#.#.#.#.#...#
###.#.#####.###.#.###.#.#.#.#.#.#.#.#.#############.#.###########.#######.###.#######.#.###.#.#####.#.#.#.#.#####.###.#.#.###.#.#v#.#.#.#.###
#...#.......#...#...#.#.#...#.#.#.#.#...........#...#.###.........#.....#...#.#.......#...#.#.#...#.#...#...#...#.#...#.#...#.#.>.#...#...###
#.###########.#####.#.#.#####.#.#.#.###########.#.###.###.#########.###.###.#.#.#########.#.#.#.#.#.#########.#.#.#.###.###.#.###v###########
#.....#.....#.#...#.#.#...###...#.#.#...........#...#...#...........#...###...#.......#...#.#...#.#.#...#.....#...#...#...#...###...........#
#####.#.###.#.#.#.#.#.###.#######.#.#.#############.###.#############.###############.#.###.#####.#.#.#.#.###########.###.#################.#
#####...#...#...#.#.#.#...#.....#...#...........###.....#.........#...#...#.........#.#.....#...#...#.#.#.......#####.....#.................#
#########.#######.#.#.#.###.###.###############.#########.#######.#.###.#.#.#######.#.#######.#.#####.#.#######.###########.#################
#.......#.......#.#.#.#.###...#...#.............#...#...#.......#...#...#.#...#...#...###.....#.#...#.#.......#...........#.................#
#.#####.#######.#.#.#.#.#####.###.#.#############.#.#.#.#######.#####.###.###.#.#.#######.#####.#.#.#.#######.###########.#################.#
#.....#.....#...#...#...#...#.#...#.......###...#.#...#.....#...#.....#...#...#.#...#...#...#...#.#.#...#...#...........#.#####.......#.....#
#####.#####.#.###########.#.#.#.#########.###.#.#.#########.#.###.#####.###.###.###.#.#.###.#.###.#.###v#.#.###########.#.#####.#####.#.#####
#...#.....#...#...#...###.#.#.#...#.....#...#.#.#...#.......#...#.....#.###...#.#...#.#.#...#...#.#.#.>.>.#.....#...###...#.....#...#...#...#
#.#.#####.#####.#.#.#.###.#.#.###.#.###.###.#.#.###.#.#########v#####.#.#####.#.#.###.#.#.#####.#.#.#.#v#######.#.#.#######.#####.#.#####.#.#
#.#...#...#...#.#.#.#.###.#.#.#...#...#.....#.#.....#.........>.>.....#.....#...#.#...#...#####.#.#.#.#.#...#...#.#.#...###.......#.......#.#
#.###.#v###.#.#.#.#.#.###.#.#.#.#####.#######.#################v###########.#####.#.###########.#.#.#.#.#.#.#.###.#.#.#.###################.#
#...#.#.>.#.#.#.#...#...#.#.#.#...###.......#.........###...###...#.........###...#...........#.#.#.#.#.#.#.#...#.#.#.#.#...#...###...#...#.#
###.#.#v#.#.#.#.#######.#.#.#.###.#########.#########.###.#.#####.#.###########.#############.#.#.#.#.#.#.#.###.#.#.#.#.#.#.#.#.###v#.#.#.#.#
#...#...#.#.#.#.....#...#.#.#.#...#...###...#.....#...#...#...#...#...#...#...#.....#.........#.#.#.#.#...#...#.#.#.#.#...#.#.#...>.#...#...#
#.#######.#.#.#####.#.###.#.#.#.###.#.###v###.###.#.###.#####.#.#####.#.#.#.#.#####.#.#########.#.#.#.#######.#.#.#.#.#####.#.#####v#########
#...#...#...#.#...#.#...#.#.#.#...#.#...>.>.#.#...#...#.....#.#...###...#.#.#...#...#.........#...#.#.#.......#.#.#...#...#...#...#.........#
###.#.#.#####.#.#.#.###.#.#.#.###.#.#####v#.#.#.#####.#####.#.###.#######.#.###.#.###########.#####.#.#.#######.#.#####.#.#####.#.#########.#
#...#.#.###...#.#.#.#...#.#.#...#.#.#.....#...#.......###...#.#...#.......#.#...#.#...#.....#.#...#...#.......#...###...#.......#...#.....#.#
#.###.#.###.###.#.#.#.###.#.###.#.#.#.###################.###.#.###.#######.#.###v#.#.#.###.#.#.#.###########.#######.#############.#.###.#.#
#.#...#...#.....#...#...#.#...#.#.#.#.....#...#.....###...###.#...#.....#...#.#.>.>.#...###...#.#...#.........###...#.....#.......#.#...#...#
#.#.#####.#############.#.###.#.#.#.#####.#.#.#.###.###.#####.###.#####.#.###.#.#v#############.###.#.###########.#.#####.#.#####.#.###.#####
#...#...#.............#.#.#...#.#.#...###...#.#...#.....#####.....###...#...#.#.#.#...........#.#...#.............#...###...#.....#.#...#...#
#####.#.#############.#.#.#.###.#.###.#######.###.###################.#####.#.#.#.#.#########.#.#.###################.#######.#####.#.###.#.#
#.....#...............#...#.....#.....#.......###.........#.....#.....#.....#...#...#.........#.#.#...#...............#...#...#...#...###.#.#
#.#####################################.#################.#.###.#.#####.#############.#########.#.#.#.#.###############.#.#.###.#.#######.#.#
#...........#...###...#...#.........###...........#.......#...#.#.#.....#...#.........###.....#.#.#.#.#...#.....#...#...#.#.....#.........#.#
###########.#.#.###.#.#.#.#.#######.#############.#.#########.#.#.#.#####.#.#.###########.###.#.#.#.#.###.#.###.#.#.#.###.#################.#
###...###...#.#...#.#.#.#.#.#.......#.............#...#####...#.#...#...#.#.#...........#.#...#.#.#.#.###...#...#.#.#.#...#.....#.........#.#
###.#.###v###.###.#.#.#.#.#.#.#######.###############.#####.###.#####.#.#.#.###########.#.#.###.#.#.#.#######v###.#.#.#.###.###.#.#######.#.#
#...#...#.>.#.#...#.#...#...#.......#.............###...#...#...#...#.#.#.#.....#.......#.#.....#...#.......>.>.#.#.#.#...#...#...#.....#...#
#.#####.#v#.#.#.###.###############.#############.#####.#.###.###.#.#.#.#.#####.#.#######.###################v#.#.#.#.###.###.#####.###.#####
#.....#...#.#.#...#.#.......#.......#...#.........#.....#...#...#.#.#.#.#.....#.#...#...#...........###...#...#.#.#.#.#...###.......#...#...#
#####.#####.#.###.#.#.#####.#.#######.#.#.#########.#######.###.#.#.#.#.#####.#.###.#.#.###########.###.#.#.###.#.#.#.#.#############.###.#.#
#...#.....#...###.#.#.#...#...###...#.#.#...###...#...#...#...#.#.#.#.#.#...#.#.###...#.#.....#.....#...#.#...#.#.#...#...###...#...#...#.#.#
#.#.#####.#######.#.#.#.#.#######.#.#.#.###.###.#.###v#.#.###.#.#.#.#.#.#.#.#.#.#######v#.###.#.#####.###.###.#.#.#######.###v#.#.#.###.#.#.#
#.#.#...#.......#...#.#.#.###...#.#.#.#.###.#...#.#.>.>.#...#.#...#.#.#.#.#.#.#...#...>.>.###.#.#.....###.....#...#.......#.>.#...#.#...#.#.#
#.#.#.#.#######.#####.#.#.###.#.#.#.#.#.###v#.###.#.#v#####.#.#####.#.#.#.#.#.###.#.###v#####.#.#.#################.#######.#v#####.#.###.#.#
#.#.#.#.........#.....#.#.#...#...#.#.#...>.>.###.#.#.#...#...#.....#.#.#.#.#.#...#.#...#####...#.....#...###...###.........#.....#...#...#.#
#.#.#.###########.#####.#.#.#######.#.#####v#####.#.#.#.#.#####.#####.#.#.#.#.#.###.#.###############.#.#.###.#.#################.#####.###.#
#.#.#.........###...#...#.#.#.....#...#...#...###.#.#...#.....#.#...#.#.#.#.#.#...#.#.....#.......#...#.#.....#...#...............#.....#...#
#.#.#########.#####.#.###.#.#.###.#####.#.###.###.#.#########.#.#.#.#.#.#.#.#.###.#.#####.#.#####.#.###.#########.#.###############.#####.###
#.#.....#...#...###.#.#...#.#...#...#...#.....#...#.#.........#.#.#...#...#...###.#.#.....#.....#...###.#.........#...#.............#.....###
#.#####.#.#.###.###.#.#.###.###.###.#.#########.###.#.#########.#.###############.#.#.#########.#######.#.###########.#.#############.#######
#.#...#...#.....#...#.#...#...#...#.#.......###.....#.........#...#.....#...#...#...#.....#.....#.......#.........###...#.............#.....#
#.#.#.###########.###.###.###.###.#.#######.#################.#####.###.#.#.#.#.#########.#.#####.###############.#######.#############.###.#
#...#...........#...#...#...#.#...#.........#...#...#...#...#...###.#...#.#...#.....#...#.#.......#...#...#...#...#.....#...............#...#
###############.###.###.###.#.#.#############.#.#.#.#.#.#.#.###.###.#.###.#########.#.#.#.#########.#.#.#.#.#.#.###.###.#################.###
#.............#...#...#.###...#...#...#.....#.#...#...#...#.#...#...#...#.#.....###...#.#.#...#.....#.#.#...#.#.###...#.....#...#...#...#...#
#.###########.###.###.#.#########.#.#.#.###.#.#############.#.###.#####.#.#.###.#######.#.#.#.#.#####.#.#####.#.#####.#####.#.#.#.#.#.#.###.#
#...........#.#...###...#####...#...#...#...#.............#...###...#...#.#.###...#...#...#.#.#.....#...#...#...#...#.....#...#...#.#.#...#.#
###########.#.#.#############.#.#########.###############.#########.#.###.#.#####.#.#.#####.#.#####.#####.#.#####.#.#####.#########.#.###.#.#
#...........#...###.....#.....#.....#.....###...#.....#...#.....###.#.###...#.....#.#...###.#.......#...#.#.###...#...###.......###...###...#
#.#################.###.#.#########.#.#######.#.#.###.#.###.###.###.#.#######.#####.###.###.#########.#.#.#.###.#####.#########.#############
#.#.......#...#...#...#.#.........#.#.#...###.#.#...#.#...#...#.....#...#...#...###...#.#...#...#.....#...#...#...#...#...#.....#...#.......#
#.#.#####.#.#.#.#.###.#.#########.#.#.#.#.###.#.###.#.###v###.#########.#.#.###.#####.#.#.###.#.#.###########.###.#.###.#.#.#####.#.#.#####.#
#...#.....#.#...#.###.#.###.......#.#.#.#...#.#.#...#.#.>.>.#.#.........#.#.###...#...#.#.#...#...#...........#...#...#.#.#.....#.#.#.#.....#
#####.#####.#####.###.#.###.#######.#.#.###.#.#.#.###.#.###.#.#.#########.#.#####.#.###.#.#.#######.###########.#####.#.#.#####.#.#.#.#.#####
#.....#...#.#.....#...#.#...#...###...#...#.#.#.#.###...###.#.#...###...#.#.###...#.#...#...###...#.........###...#...#.#.###...#.#.#.#.....#
#.#####.#.#.#.#####.###.#.###.#.#########.#.#.#.#.#########.#.###.###.#.#.#.###v###.#.#########.#.#########.#####.#.###.#.###v###.#.#.#####.#
#.......#.#.#.###...#...#.....#...###...#.#.#.#.#.........#.#.###...#.#.#.#.#.>.>.#.#...###...#.#...........#...#.#.#...#.#.>.###.#.#.#.....#
#########.#.#.###.###.###########.###.#.#.#.#.#.#########.#.#.#####.#.#.#.#.#.###.#.###.###.#.#.#############.#.#.#.#.###.#.#v###.#.#.#.#####
###...#...#.#...#.#...#.....#.....#...#...#...#.......#...#.#.#.....#.#.#.#.#.###.#.###...#.#.#.....#.....#...#.#.#.#.#...#.#...#.#.#.#.#...#
###.#.#.###.###.#.#.###.###.#.#####.#################.#.###.#.#.#####.#.#.#.#.###.#.#####.#.#.#####.#.###.#.###.#.#.#.#.###.###.#.#.#.#.#.#.#
#...#...#...#...#.#.###.#...#...###...............#...#...#...#...#...#...#.#...#.#.#.....#.#...#...#.###.#.###.#.#...#...#...#...#.#.#.#.#.#
#.#######.###.###.#.###.#.#####v#################.#.#####.#######.#.#######.###.#.#.#.#####.###.#.###.###.#.###.#.#######.###.#####.#.#.#.#.#
#.#.....#...#...#.#...#.#...#.>.>.#...#...........#...#...#.......#.#.......#...#.#.#.....#.#...#...#...#...#...#.....#...#...###...#.#...#.#
#.#.###.###.###.#.###.#.###.#.###.#.#.#.#############.#.###.#######.#.#######.###.#.#####.#.#.#####v###.#####.#######.#.###.#####.###.#####.#
#.#.#...#...#...#...#.#.#...#...#.#.#.#...........#...#...#...#...#.#...#...#...#.#.#.....#.#.#...>.>.#...#...#.....#.#...#.#.....#...#.....#
#.#.#.###.###.#####.#.#.#.#####.#.#.#.###########.#.#####.###.#.#.#.###.#.#.###.#.#.#.#####.#.#.#####.###.#.###.###.#.###.#.#.#####.###.#####
#...#.....###.......#...#.......#...#.............#.......###...#...###...#.....#...#.......#...#####.....#.....###...###...#.......###.....#
###########################################################################################################################################.#
`;


const grid = input.trim().split("\n").map(line => line.split(""));

const rowSize = grid.length;
const colSize = grid[0].length;

const start = [0, grid[0].map((item, index) => item === "." ? index : undefined).find(Boolean)];
const end = [grid.length-1, grid[grid.length-1].map((item, index) => item === "." ? index : undefined).find(Boolean)];

const pathNeighbors = [[-1, 0], [0, 1], [1, 0], [0, -1]];
const isValid = ([row, col]) => row >= 0 && row < rowSize && col >= 0 && col < colSize && grid[row][col] !== "#";

const getNeighbors = ([row, col]) => {
    return pathNeighbors.map(([deltaRow, deltaCol]) => (
        [row+deltaRow, col+deltaCol]
    )).filter(isValid);
};

const startingPoints = [start, end];
grid.forEach((row, rowIndex) => row.forEach((col, colIndex) => {
    if(getNeighbors([rowIndex, colIndex])?.length > 2 && col !== "#") {
        startingPoints.push([rowIndex, colIndex]);
    }
}));


const graph = {};
startingPoints.forEach(([r, c]) => graph[`${r},${c}`] = [])

for (let point of startingPoints) {
    let queue = [[...point, 0]];
    const visited = {};
    visited[`${point[0]},${point[1]}`] = true;

    while (queue.length > 0) {
        let [row, col, distance] = queue.pop();
        if (distance > 0 && startingPoints.some(x => x[0] === row && x[1] === col)) {
            graph[`${point[0]},${point[1]}`].push([row,col, distance]);
            continue;
        }

        getNeighbors([row, col]).forEach(([nRow, nCol]) => {
            if (isValid([nRow, nCol]) && !visited[`${nRow},${nCol}`]) {
                queue.push([nRow, nCol, distance+1]);
                visited[`${nRow},${nCol}`] = true;
            }
        })
    }

}

const visited = {};
const dfs = ([row, col]) => {
    if (row === end[0] && col === end[1])
        return 0;

    let max = 0;
    visited[`${row},${col}`] = true;

    for (const [gRow, gCol, distance] of graph[`${row},${col}`])
        if (!visited[`${gRow},${gCol}`])
            max = Math.max(max, dfs([gRow, gCol]) + distance);

    visited[`${row},${col}`] = false;

    return max;

}
console.log(dfs(start))